\documentclass{article}

\usepackage[pdftex]{graphicx}
%\usepackage{thumbpdf}
%\usepackage[naturalnames]{hyperref}
\usepackage{xr}
\externaldocument{paper}

\usepackage{bm, booktabs}
\usepackage{amsmath}%
\usepackage{amsfonts}%
\usepackage{amssymb}%
%\usepackage{amsthm}
\usepackage{mathrsfs}
%\usepackage{graphicx}
%\usepackage{setspace}
\usepackage{cite}
\usepackage{units}
	%nice looking units
%\usepackage{times}
\usepackage[normalem]{ulem}
%\usepackage{algorithmic}
%\usepackage[figure, vlined, linesnumbered]{algorithm2e}
\usepackage[vlined, linesnumbered]{algorithm2e}
%\usepackage{algorithm}

%%%%% set up the bibliography style
\bibliographystyle{../IEEEbst}
%\usepackage[square,comma,numbers]{natbib}

\newcommand{\fracpart}[1]{\left\langle #1 \right\rangle}
\newcommand{\sfracpart}[1]{\langle #1 \rangle}
\newcommand{\round}[1]{\lfloor #1 \rceil}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}
\newcommand{\ceil}[1]{\lceil #1 \rceil}
\newcommand{\abs}[1]{{\left\vert #1 \right\vert}}
\newcommand{\sabs}[1]{{\vert #1 \vert}}
\newcommand{\reals}{{\mathbb R}}
\newcommand{\ints}{{\mathbb Z}}
\newcommand{\integers}{{\mathbb Z}}
\newcommand{\uy}{\underline{\bm{Y}}}
\newcommand{\uey}{\underline{Y}} 
\newcommand{\sign}[1]{\mathtt{sign}(#1)}
\newcommand{\Qbf}{{\mathbf Q}}
\newcommand{\Bbf}{{\mathbf B}}
\newcommand{\Ibf}{{\mathbf I}}
\newcommand{\ybf}{{\mathbf y}}
\newcommand{\xbf}{{\mathbf x}}
\newcommand{\zbf}{{\mathbf z}}
\newcommand{\ebf}{{\mathbf e}}
\newcommand{\vbf}{{\mathbf v}}
\newcommand{\wbf}{{\mathbf w}}
\newcommand{\kbf}{{\mathbf k}}
\newcommand{\sbf}{{\mathbf s}}
\newcommand{\tbf}{{\mathbf t}}
\newcommand{\pbf}{{\mathbf p}}
\newcommand{\Pibf}{{\mathbf \Pi}}
\newcommand{\onebf}{{\mathbf 1}}
\newcommand{\fbf}{{\mathbf f}}
\newcommand{\ubf}{{\mathbf u}}
\newcommand{\expect}{{\mathbb E}}

\newcommand{\NP}{\operatorname{NearestPt}}
\newcommand{\NS}{\operatorname{NearestSet}}
\newcommand{\bres}{\operatorname{Bres}}
\newcommand{\vol}{\operatorname{vol}}
\newcommand{\vor}{\operatorname{Vor}}
\newcommand{\coef}{\operatorname{Coef}}
\newcommand{\Int}{\operatorname{Int}}

\newtheorem{theorem}{Theorem}

\begin{document}


\section{Comments from reviewer 1}

\begin{enumerate}

\item \textbf{Comment:} Consistently write ``non-data-aided'' throughout the whole text \\
\textbf{Response:} Done.

\item \textbf{Comment:} Page (P) 42, right column (RC), line (L) 50: Aside from this extension of \dots \\
\textbf{Response:} Fixed.


\item \textbf{Comment:} P 43, LC, L 44: \dots convincing response \dots \\
\textbf{Response:} Fixed.

\item \label{eq:rev1:multantenna} \textbf{Comment:} P 43, RC, L 2+4: \dots as multiple antenna systems \dots must withstand rapidly \dots \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} P 43, RC, L 21+28: \dots aided the design of \dots to other receiver components \dots \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} Conference papers: location missing \\
\textbf{Response:} The location of conferences has been added.

\item \textbf{Comment:} Some journal papers: month of publication missing \\
\textbf{Response:} The month has been added whenever it was available in the original publication. 

\item \textbf{Comment:} [8] \dots IEEE Commun. Letters \dots \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} [31] N. Noels, V. Lottici, \dots \\
\textbf{Response:} Fixed.

\end{enumerate}

\section{Comments from reviewer 2}

\begin{enumerate}

\item \textbf{Comment:} In the abstract: non data-aided $\to$ change to: non-data-aided \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} ``we assume that the time-offset has been previously handled'' $\to$ perhaps some motivation for this assumption and the consequences with respect to the system model would be in place \\
\textbf{Response:}  The assumption of an accurate time offset estimator is common in this literature~\cite{ViterbiViterbi_phase_est_1983,Cowley_ref_sym_carr_1998,Wilson1989,Makrakis1990,Liu1991,Mackenthun1994,Sweldens2001,McKilliamLinearTimeBlockPSK2009,Divsalar1990} and is unlikely to come as a surprise to the intended audience.  There exist numerous estimators for the time offset in the literature.  We have added the sentence 

``Methods for estimating the time offset are given in~\cite{Massey1972optimumframe,Oerder_synch_square_circstat_2008,McKilliam_time_offset_pilots_data_2013}.'' 

to inform the reader of some of these methods.  The reader interested in the motivation and consequences of this assumption can consult this literature.


\item \textbf{Comment:} ``such as binary phase shift keying (BPSK), \dots'' $\to$ mentioning BPSK and QPSK apart from general M-PSK is pure overhead in this stage, I would drop it \\
\textbf{Response:} Done.

\item \textbf{Comment:} ``the data symbols are not known to the receiver and must also be estimated'' $\to$ I would drop the second part of the sentence because (e.g. Viterbi and Vterbi estimator) non-data-aided estimators typically do not actually estimate the unknown data symbols \\
\textbf{Response:} Done.

\item \textbf{Comment:} p. 3: ``bounds that are valid asymptoticially'': typo in asymptotically \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} p. 3: ``all of the exiting bounds are applicable only in the fully non-data-aided case or in the completely data-aided case \dots'' $\to$ bounds for the common scenario where there is a mixture of pilot and data symbols can be found in ``N. Noels, H. Steendam, M. Moeneclaey en H. Bruneel, Carrier Phase and Frequency Estimation for Pilot Symbol Assisted Transmission: Bounds and Algorithms, IEEE TSP, Vol. 53, No. 12, p. 4578-4587, Dec. 2005.'' \\
\textbf{Response:} We have added this reference and have removed the sentences begining ``To the authors' knowledge, all of the existing bounds are applicable only in the fully non-data-aided case \dots''. Note that the model considered in the paper by Noels~et.~al.~\cite{Noels_crbs_with_pilots_2005} treats the amplitude as fixed and known and includes a frequency offset term.  Thus, the bounds are not immediately applicable in our setting and we are not able to meaningfully compare these bounds with our simulation results.  %For this reason with have kept with the bound described in~\cite{950345} as in the previous version of the manuscript.

\item \textbf{Comment:} p. 3: ``the situations is'' $\to$ drop `s' at the end of situations \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} p. 3: in continuous text I prefer the use of ``approached infinity'' rather than ``$\to \infty$'' \\
\textbf{Response:} This change has been made wherever it occurs in the introduction, but not throughout the whole text. This is a personal preference of the authors.

\item \textbf{Comment:} p. 3: last line: typo in ``convincing'' \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} p. 4: ``systems such as mulitple anntannae'' $\to$ should be ``multiple antennae'' \\
\textbf{Response:} Reviewer 1 comment~\eqref{eq:rev1:multantenna} wanted ``antenna'' and we have used this spelling.

\item \textbf{Comment:} p. 4: ``the other reciever components'' $\to$ should be ``receiver components'' \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} p. 5 (and further throughout the text): ``pilots symbols" (with `s') and ``pilot symbols'' (without `s') are both used $\to$ use only 1, I prefer ``pilot symbols'' \\
\textbf{Response:} All occurences of ``pilots symbols'' have been changed to ``pilot symbols''. 

\item \label{rev2:commentnotationsection} \textbf{Comment:} I think it would be a good idea to specify the main notational conventions at the end of the introductory section \\
\textbf{Response:} We respectfully request not to make this change.  It is the authors' preference to introduce notation as it is used in the text rather than in a dedicated notation section. %BLERG. This need to be done. It's connected with comment~\ref{rev2:commentE}.

\item \textbf{Comment:} between (5) and (6): start new paragraph \\
\textbf{Response:} Done.  The paragraph ends at ``\dots least squares estimator of the data symbols~\cite{Sweldens2001,Mackenthun1994}'' and the new paragraph begins with ``To see this, let $a = \rho e^{j\theta}$ \dots''

\item \textbf{Comment:} before (6): drop the 'to' \\
\textbf{Response:} Done.

\item \textbf{Comment:} before (7): change ``for given $\theta$'' to ``for given $\theta$ and $\rho$'' \\
\textbf{Response:} Done.

\item \textbf{Comment:} what is the use of keeping the constants `A' and `B' in the expressions $\to$ can they not be dropped? \\
\textbf{Response:} The constants are retained so that statements of equality, such as
\[
LS(\{d_i, i \in D\}) = A - \frac{1}{L}\abs{Y}^2
\]
are valid. For the purpose of minimisation the constants have no effect.  However, in this case, we feel that introducing notation to describe ``equivalent for the purpose of minimisation'' is more cumbersome than simply retaining constants in the few cases that they occur.

\item \textbf{Comment:} I would prefer to see comma's between two subindices; so, `$k,i$' rather than`'$ki$' \\
\textbf{Response:} Done.

\item \textbf{Comment:} below (11) '$g_{ik}$' should be '$g_{ki}$' (change order of the subscripts) \\
\textbf{Response:} Fixed.

\item \label{rev2:commentE} \textbf{Comment:} I would prefer to see brackets around the functions of which the mean is computed (use of the operator $\mathbb E$) \\
\textbf{Response:} We prefer not to use brackets whenever there is no chance of ambiguity.  To clarify this for the reader the following sentences have been added to Section~\ref{sec:stat-prop-least}:

``Whenever there is no chance of ambiguity we write simply $\expect X$ rather than $\expect(X)$ to denote the expected value of the random variable $X$.  For two random variables $X$ and $Y$ the notation $\expect X Y$ will always mean the expected value of the product $XY$, that is, $\expect(XY)$ and not $\expect(X)Y$.''

The bracketless notation is heavily employed in the statistical literature on empirical processes~\cite{Pollard_new_ways_clts_1986,Pollard_conv_stat_proc_1984,Pollard_asymp_empi_proc_1989,van2009empirical}. The notation would become heavily cluttered otherwise.  Our proofs in the appendix rely upon this literature.

\item \textbf{Comment:} p. 12: ``the amplitude estimation error with bias removed'' $\to$ bit strange formulation \\
\textbf{Response:} This phrase has been removed.

\item \textbf{Comment:} p. 14: ``Equivalently $\hat\theta$ is the maximiser of \dots'' $\to$ could you please provide some further explanation (is the maximum of $\Re(Z(\theta))$ never negative? and why) \\
\textbf{Response:} The least squares phase estimator is the minimiser of
\[
LS(\theta) = A - \frac{1}{L}\Re(Z(\theta))^2.
\]
Because the least squares amplitude estimator $\hat{\rho} = \Re(Z(\hat{\theta}))$ is positive by definition, we are only interested in those values of $\theta$ that correspond with a positive amplitude estimator, that is, such that
\[
\hat{\rho}(\theta) = \Re(Z(\theta)) > 0.
\]
Thus, the least squares phase estimator $\hat{\theta}$ must be such that
\[
\hat{\rho} = \Re(Z(\hat{\theta})) > 0.
\]
This is explained in the text by the sentences:

``By definition the amplitude $\rho_0$ and its estimator $\hat{\rho}$ are positive.  However, $\hat{\rho}(\theta) = \Re(Z(\theta))$ may take negative values for some $\theta \in [-\pi,\pi)$.  The least square estimator $\hat{\theta}$ of $\theta_0$ is the minimiser of $LS(\theta)$ under the constraint $\hat{\rho}(\theta) = \Re(Z(\theta)) > 0$.  Equivalently $\hat{\theta}$ is the maximiser of $\Re(Z(\theta))$ with no constraints required.''

\item \textbf{Comment:} p. 15: the use of `A' as notation for a sample space is confusing since `A' has already been used as a constant \\
\textbf{Response:} $A$ has been replaced by $\Sigma$ and $A^\prime$ by $\Sigma^\prime$.

\item \textbf{Comment:} in general, I find the numerical results section rather short \\
\textbf{Response:} We have greatly expanded the simulation section as detailed in the responses that follow.

\item \textbf{Comment:} although different figures are shown for M=2,4,8 (phase estimation), the effect of the constellation size is not addressed in the text  \\
\textbf{Response:}  We have included the follows sentences to Section~\ref{sec:simulations}:

``As expected, the figures indicate the estimator to become more accurate as the number of pilot symbols is increased.  An interesting property distriguishing the case when no pilot symbols exist is the slope of the MSE curve at low SNR.  When a finite proportion of pilot symbols exist the slope at low SNR is similar to that when all symbols are pilots.  The slope is steeper in the case that no pilot symbols exist.''

\item \textbf{Comment:} p. 18, first sentence: ``when $L$ is sufficiently large'' $\to$ in these figures the value of $L$ is fixed, should this be ``when the SNR is sufficiently large''  \\
\textbf{Response:} Fixed.

\item \textbf{Comment:} p. 18, first sentence: a qualitative explanation for the fact the theory and simulations diverge at low SNR would be appreciated  \\
\textbf{Response:} BLERG: Added a reference to Tazras crb paper.

\item \textbf{Comment:} p.18, last sentence of first paragraph: ``non-data aided'' $\to$ should be ``non-data-aided''  \\
\textbf{Response:} Fixed.

\item \textbf{Comment:}  although the most important contribution of the paper is with respect to the biased amplitude estimate, only 1 figure is presented for amplitude estimation, namely for $L=2048$ and BPSK $\to$ this seems not well balanced  \\
\textbf{Response:} Figures have been added showing the amplitude estimation error for BSPK, QPSK, and 8-PSK.

\item \textbf{Comment:}  a separate plot of the two terms that contribute to Fig. 4 would be welcome \\

\textbf{Response:}

\end{enumerate}

\section{Comments from reviewer 3}

\begin{enumerate}

\item \textbf{Comment:}  Eq. (14) would be easier to follow with the intermediate step inserted $\dots = (a_0s_i + w_i)/(a_0s_i) = \dots$ \\
\textbf{Response:} Done.

\item \textbf{Comment:}  There are many formulas (starting from page 11) with the notation $\fracpart{x}$ meaning ``$x$ taken modulo $2\pi/M$''. These angle brackets don't strike the eye and can be easily confused with ordinary parentheses. To make them much more visible, the authors could use the same approach as for ``$x$ taken modulo $2\pi$'' - by using corresponding subscript, i.e. use $\fracpart{x}_{2\pi/M}$ instead of $\fracpart{x}$. \\
\textbf{Response:} We request not to make this change.  There are two reasons.  The first is that this notation leads to situations where there are subscripts withing superscripts.  For example, in the proof of Theorem 1 we would have expressions of the form
\[
\rho_0 R_i e^{j\sfracpart{\lambda + \Phi_i}_{2\pi/M}}
\]
and in the appendix we would obtain expressions such as
\[
2 \hat{\rho} \rho_0 R_k \Re\left( \eta e^{j\sfracpart{\hat{\lambda}_L + \Phi_k}_{2\pi/M}}\right)
\]
and
\[
q_2(\lambda) + j k_2(\lambda) = \expect\big[ R_1 e^{j\fracpart{\lambda + \Phi_1}_{2\pi/M}} - R_1 e^{j\fracpart{\Phi_1}_{2\pi/M}}  \big].
\]
We feel that these are more difficult to parse that the existing simpler
\[
\rho_0 R_i e^{j\sfracpart{\lambda + \Phi_i}},
\]
\[
2 \hat{\rho} \rho_0 R_k \Re\left( \eta e^{j\sfracpart{\hat{\lambda}_L + \Phi_k}}\right),
\]
and
\[
q_2(\lambda) + j k_2(\lambda) = \expect\big[ R_1 e^{j\fracpart{\lambda + \Phi_1}} - R_1 e^{j\fracpart{\Phi_1}}  \big].
\]

The second reason is that some of the authors have made use of the notation $\fracpart{\cdot}$ is previous work~\cite{McKilliamFrequencyEstimationByPhaseUnwrapping2009,McKilliam_mean_dir_est_sq_arc_length2010,McKilliam_pps_unwrapping_tsp_2014} and there is a desire for continuity in the notation between these papers.

 \end{enumerate}

\section{Comments from reviewer 4}

\begin{enumerate}

\item \textbf{Comment:}  The variable  ``a'' in the equation 2 is not defined in the text \\
\textbf{Response:} In~\eqref{eq:LSdefn} the variable $a$ is an argument of the function $LS$, that is,
\[
\begin{split}
LS(a, &\{d_i, i \in D\}) = \sum_{i \in P \cup D} \abs{ y_i - a s_i }^2  \\
&= \sum_{i \in P} \abs{ y_i - a p_i }^2 + \sum_{i \in D} \abs{ y_i - a d_i }^2.
\end{split}
\]

\item \textbf{Comment:}  There are typografical errors in the words  ``multiple antenna'' in line 2, page 2, section 1 \\
\textbf{Response:} Fixed.

\item \textbf{Comment:}  And also in the word ``receiver" in line 28 of the same page.
 \\
\textbf{Response:} Fixed.


\end{enumerate}

\input{paper.bbl}

\end{document}
